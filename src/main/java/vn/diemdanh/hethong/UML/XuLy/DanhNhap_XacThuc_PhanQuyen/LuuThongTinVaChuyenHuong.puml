@startuml
!theme plain
title 3. Lưu thông tin và Chuyển hướng

actor User as U
participant "LoginForm.jsx" as LF
participant "AuthContext.jsx" as AC
participant "api.js" as API

== Lưu thông tin đăng nhập và chuyển hướng ==

API -> AC: Successful login response
activate AC
note right: Response chứa:\n- accessToken\n- user info\n- role

AC -> AC: Lưu vào localStorage:
note right of AC
- accessToken
- user (thông tin người dùng)
- userRole (STUDENT/TEACHER/ADMIN)
end note

AC -> AC: Cập nhật AuthContext state:
note right of AC
- user
- userRole
- isAuthenticated = true
end note

AC -> U: Chuyển hướng đến dashboard tương ứng:
note right
- STUDENT → /student/dashboard
- TEACHER → /teacher/dashboard
- ADMIN → /admin/dashboard
end note
deactivate AC

== Xử lý lỗi từ Backend ==

alt Có lỗi từ API
    API -> AC: Error response
    activate AC
    AC -> LF: Truyền thông báo lỗi
    activate LF
    LF -> U: Hiển thị thông báo lỗi
    deactivate LF
    deactivate AC
end

@enduml
