@startuml
title Tìm kiếm Tài Khoản Giảng viên

actor "Admin" as admin
participant "DanhSachTaiKhoanSV\nComponent" as frontend
participant "Ant Design\nInput.Search" as searchInput
participant "userService.js" as service
participant "UserController" as controller
participant "UserService" as userService
participant "UserRepository" as repository
database "Database" as db

== Tìm kiếm Tài Khoản Giảng viên ==
admin -> searchInput: Nhập từ khóa tìm kiếm
activate searchInput
searchInput -> frontend: onSearch(keyword)
activate frontend
frontend -> frontend: handleSearch(keyword)
frontend -> frontend: Update tableParams
frontend -> frontend: useEffect trigger do tableParams thay đổi
frontend -> frontend: Gọi fetchTeachers() với search param

frontend -> service: getUsersByRole
note right: Gửi thêm tham số search
activate service
service -> controller: Gọi API
activate controller

controller -> controller: Kiểm tra tham số search
alt search param không rỗng
    controller -> userService: searchUsersByRole
    activate userService
    userService -> repository: findByRoleAndSearch
    activate repository
    repository -> db: Truy vấn

else search param rỗng
    controller -> userService: getUsersByRole
    userService -> repository: findByRole
    repository -> db: Truy vấn
end

db --> repository: List<User>
repository --> userService: Page<User>
deactivate repository

userService -> userService: Convert to UserDto list
userService --> controller: Page<UserDto> (filtered results)
deactivate userService

controller --> service: JSON Response (filtered)
deactivate controller

service --> frontend: filtered students data
deactivate service

frontend -> frontend: setState(student) với kết quả lọc
frontend -> frontend: Update pagination info cho kết quả tìm kiếm

frontend -> frontend: Render bảng với kết quả tìm kiếm
alt Có kết quả
    frontend -> admin: Hiển thị danh sách
else Không có kết quả
    frontend -> admin: Hiển thị "Không tìm thấy kết quả"
end

== Xóa từ khóa tìm kiếm ==
admin -> searchInput: Xóa từ khóa hoặc click Clear
searchInput -> frontend: onSearch("")
frontend -> frontend: handleSearch("")
frontend -> frontend: Reset tableParams.search = ""
frontend -> frontend: Gọi lại fetchTeachers() không có search
frontend -> admin: Hiển thị lại toàn bộ danh sách
deactivate searchInput
deactivate frontend

@enduml