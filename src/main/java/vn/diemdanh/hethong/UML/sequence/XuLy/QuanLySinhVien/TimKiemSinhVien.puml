@startuml
!theme plain
title Tìm kiếm và lọc sinh viên

actor "Admin" as admin
participant "DanhSachSinhVienComponents.jsx" as component
participant "Ant Design Input.Search" as searchInput
participant "Ant Design Select" as selectLop
participant "Ant Design Select" as selectKhoa
participant "studentService.js" as studentService
participant "SinhVienController" as controller
participant "SinhVienService" as service
participant "SinhVienRepository" as repository
database "Database" as db

== Tìm kiếm theo từ khóa ==
admin -> searchInput: Nhập từ khóa (MSSV, Họ tên, Email)
searchInput -> component: onSearch(keyword)
component -> component: setFilters({search: keyword})
component -> component: Gọi lại getFilteredData()

== Lọc theo lớp ==
admin -> selectLop: Chọn lớp
selectLop -> component: onChange(filterLop)
component -> component: setFilters({filterLop})
component -> component: Gọi lại getFilteredData()

== Lọc theo khoa ==
admin -> selectKhoa: Chọn khoa
selectKhoa -> component: onChange(filterKhoa)
component -> component: setFilters({filterKhoa})
component -> component: Gọi lại getFilteredData()

== Lấy dữ liệu sinh viên (nếu cần) ==
alt Dữ liệu chưa có hoặc cần làm mới
    component -> studentService: getAllStudentsNoPagination()
    studentService -> controller: GET /api/sinh-vien/all
    controller -> service: findAll()
    service -> repository: findAll()
    repository -> db: SELECT * FROM sinh_vien
    db --> repository: List<SinhVien>
    repository --> service: List<SinhVien>
    service -> service: Chuyển sang List<SinhVienDto>
    service --> controller: List<SinhVienDto>
    controller --> studentService: JSON Response
    studentService --> component: Danh sách sinh viên
end

== Áp dụng tìm kiếm và lọc (client-side) ==
component -> component: Lọc danh sách theo:
note right
- Từ khóa (MSSV, Họ tên, Email)
- Lớp (tenLop)
- Khoa (tenKhoa)
end note
component -> admin: Hiển thị kết quả tìm kiếm/lọc trong bảng

@enduml 