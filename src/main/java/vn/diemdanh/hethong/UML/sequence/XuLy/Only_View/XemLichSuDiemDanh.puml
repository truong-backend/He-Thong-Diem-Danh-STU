@startuml
!theme plain
title Sơ đồ tuần tự quy trình xem lịch sử điểm danh

actor "Sinh viên" as sv
participant "DanhSachDiemDiemSVComponents.jsx" as component
participant "diemdanhSVService.js" as diemdanhSVService
participant "DiemDanhController" as controller
participant "DiemDanhService (BE)" as service
participant "DiemDanhRepository" as repository
database "Database" as db

sv -> component: Truy cập trang Lịch sử điểm danh
activate component
component -> component: useEffect() khi mount
component -> diemdanhSVService: getLichSuDiemDanh(maSv)
activate diemdanhSVService
diemdanhSVService -> controller: GET /api/diemdanh/sinhvien/{maSv}/lichsu
activate controller
controller -> service: getLichSuDiemDanh(maSv)
activate service
service -> repository: findLichSuDiemDanhByMaSv(maSv)
activate repository
repository -> db: SELECT * FROM diem_danh WHERE maSv = ?
db --> repository: List<DiemDanh>
repository --> service: List<DiemDanh>
service -> service: Chuyển sang List<DiemDanhDto>
service --> controller: List<DiemDanhDto>
deactivate repository
deactivate service
controller --> diemdanhSVService: JSON Response (List<DiemDanhDto>)
deactivate controller
diemdanhSVService --> component: Danh sách lịch sử điểm danh
deactivate diemdanhSVService
component -> component: setLichSuDiemDanh(data)
component -> sv: Hiển thị bảng lịch sử điểm danh
@enduml 